<?php
// $Id$

/**
 * @file
 * The main module file for showmeyouremail module.
 */

/**
 * Implements hook_permission().
 */
function showmeyouremail_permission() {
  return array(
    'View user email addresses' => array(
      'title' => t('View user email addresses'),
      'description' => t('Enabling this permission will allow users to see user email addresses'),
    ),
  );
}

/**
 * Implements hook_user_view().
 */
function showmeyouremail_user_view($account, $view_mode) {

  /*check user permission to view user email addresses */

  if (user_access('View user email addresses')) {

    $content = theme('showmeyouremail_user', array('account' => $account));

    $account->content['showmeyouremail'] = array(
      '#type' => 'user_profile_item',
      '#title' => t('Email'),
      '#value' => $content,
      '#weight' => 0,
    );
  }
}

/**
 * Implements hook_user().
 */
function showmeyouremail_user_OLD($op, &$edit, &$account) { }

/**
 * hook_theme is required to register our themeable (overrideable) output
 * with drupal's theme system.
 */
function showmeyouremail_theme() {
  return array(
    'showmeyouremail_user' => array(
      'variables' => array('account' => NULL),
    ),
  );
}

/**
 * Default theme output for "showmeyouremail_user".
 *
 * Any time we create themeable output, we must provide the default
 * implementation (that can be later overridden by themers).
 */
function theme_showmeyouremail_user($variables) {
  $account = $variables['account'];

  return l($account->mail, 'mailto:' . $account->mail);
}